{"version":3,"sources":["createAppContainer.js"],"names":["React","Linking","Platform","BackHandler","NavigationActions","ThemeProvider","pathUtils","getNavigation","NavigationProvider","invariant","docsUrl","urlToPathAndParams","isStateful","props","navigation","validateProps","persistenceKey","console","warn","screenProps","persistNavigationState","loadNavigationState","theme","containerProps","keys","Object","length","Error","join","undefined","_statefulContainerCount","_TESTING_ONLY_reset_container_count","_reactNavigationIsHydratingState","createNavigationContainer","Component","NavigationContainer","getDerivedStateFromProps","nextProps","constructor","Set","url","enableURLHandling","uriPrefix","parsedUrl","path","params","action","router","getActionForPathAndParams","dispatch","nav","err","_navState","state","lastNavState","reducedState","getStateForAction","navState","dispatchActionEvents","_actionEventSubscribers","forEach","subscriber","type","lastState","setState","_onNavigationStateChange","_persistNavigationState","_initialAction","init","_isStateful","addEventListener","subs","_isMounted","remove","back","_renderLoading","renderLoadingExperimental","prevNav","onNavigationStateChange","process","env","REACT_NAV_LOGGING","group","log","groupEnd","newState","componentDidUpdate","componentDidMount","NODE_ENV","detached","OS","_linkingSub","_handleOpenURL","userProvidedStartupState","getStartupParams","startupState","urlAction","dispatchActions","loadedNavState","Promise","all","getInitialURL","componentDidCatch","e","componentWillUnmount","removeEventListener","render","_navigation","_getScreenProps","_getTheme"],"mappings":"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","sourcesContent":["/* eslint-disable react/sort-comp */\r\n\r\nimport * as React from 'react';\r\nimport { Linking, Platform, BackHandler } from 'react-native';\r\nimport {\r\n  NavigationActions,\r\n  ThemeProvider,\r\n  pathUtils,\r\n  getNavigation,\r\n  NavigationProvider,\r\n} from '@react-navigation/core';\r\nimport invariant from './utils/invariant';\r\nimport docsUrl from './utils/docsUrl';\r\n\r\nconst { urlToPathAndParams } = pathUtils;\r\n\r\nfunction isStateful(props) {\r\n  return !props.navigation;\r\n}\r\n\r\nfunction validateProps(props) {\r\n  if (props.persistenceKey) {\r\n    console.warn(\r\n      'You passed persistenceKey prop to a navigator. ' +\r\n        'The persistenceKey prop was replaced by a more flexible persistence mechanism, ' +\r\n        'please see the navigation state persistence docs for more information. ' +\r\n        'Passing the persistenceKey prop is a no-op.'\r\n    );\r\n  }\r\n  if (isStateful(props)) {\r\n    return;\r\n  }\r\n  /* eslint-disable no-unused-vars */\r\n  const {\r\n    navigation,\r\n    screenProps,\r\n    persistNavigationState,\r\n    loadNavigationState,\r\n    theme,\r\n    ...containerProps\r\n  } = props;\r\n  /* eslint-enable no-unused-vars */\r\n\r\n  const keys = Object.keys(containerProps);\r\n\r\n  if (keys.length !== 0) {\r\n    throw new Error(\r\n      'This navigator has both navigation and container props, so it is ' +\r\n        `unclear if it should own its own state. Remove props: \"${keys.join(\r\n          ', '\r\n        )}\" ` +\r\n        'if the navigator should get its state from the navigation prop. If the ' +\r\n        'navigator should maintain its own state, do not pass a navigation prop.'\r\n    );\r\n  }\r\n  invariant(\r\n    (persistNavigationState === undefined &&\r\n      loadNavigationState === undefined) ||\r\n      (typeof persistNavigationState === 'function' &&\r\n        typeof loadNavigationState === 'function'),\r\n    'both persistNavigationState and loadNavigationState must either be undefined, or be functions'\r\n  );\r\n}\r\n\r\n// Track the number of stateful container instances. Warn if >0 and not using the\r\n// detached prop to explicitly acknowledge the behavior. We should deprecated implicit\r\n// stateful navigation containers in a future release and require a provider style pattern\r\n// instead in order to eliminate confusion entirely.\r\nlet _statefulContainerCount = 0;\r\nexport function _TESTING_ONLY_reset_container_count() {\r\n  _statefulContainerCount = 0;\r\n}\r\n\r\n// We keep a global flag to catch errors during the state persistence hydrating scenario.\r\n// The innermost navigator who catches the error will dispatch a new init action.\r\nlet _reactNavigationIsHydratingState = false;\r\n// Unfortunate to use global state here, but it seems necessesary for the time\r\n// being. There seems to be some problems with cascading componentDidCatch\r\n// handlers. Ideally the inner non-stateful navigator catches the error and\r\n// re-throws it, to be caught by the top-level stateful navigator.\r\n\r\n/**\r\n * Create an HOC that injects the navigation and manages the navigation state\r\n * in case it's not passed from above.\r\n * This allows to use e.g. the StackNavigator and TabNavigator as root-level\r\n * components.\r\n */\r\nexport default function createNavigationContainer(Component) {\r\n  class NavigationContainer extends React.Component {\r\n    subs = null;\r\n\r\n    static router = Component.router;\r\n    static navigationOptions = null;\r\n\r\n    static defaultProps = {\r\n      theme: 'light',\r\n    };\r\n\r\n    static getDerivedStateFromProps(nextProps) {\r\n      validateProps(nextProps);\r\n      return null;\r\n    }\r\n\r\n    _actionEventSubscribers = new Set();\r\n\r\n    constructor(props) {\r\n      super(props);\r\n\r\n      validateProps(props);\r\n\r\n      this._initialAction = NavigationActions.init();\r\n\r\n      if (\r\n        this._isStateful() &&\r\n        BackHandler &&\r\n        typeof BackHandler.addEventListener === 'function'\r\n      ) {\r\n        this.subs = BackHandler.addEventListener('hardwareBackPress', () => {\r\n          if (!this._isMounted) {\r\n            this.subs && this.subs.remove();\r\n          } else {\r\n            // dispatch returns true if the action results in a state change,\r\n            // and false otherwise. This maps well to what BackHandler expects\r\n            // from a callback -- true if handled, false if not handled\r\n            return this.dispatch(NavigationActions.back());\r\n          }\r\n        });\r\n      }\r\n\r\n      this.state = {\r\n        nav:\r\n          this._isStateful() && !props.loadNavigationState\r\n            ? Component.router.getStateForAction(this._initialAction)\r\n            : null,\r\n      };\r\n    }\r\n\r\n    _renderLoading() {\r\n      return this.props.renderLoadingExperimental\r\n        ? this.props.renderLoadingExperimental()\r\n        : null;\r\n    }\r\n\r\n    _isStateful() {\r\n      return isStateful(this.props);\r\n    }\r\n\r\n    _handleOpenURL = ({ url }) => {\r\n      const { enableURLHandling, uriPrefix } = this.props;\r\n      if (enableURLHandling === false) {\r\n        return;\r\n      }\r\n      const parsedUrl = urlToPathAndParams(url, uriPrefix);\r\n      if (parsedUrl) {\r\n        const { path, params } = parsedUrl;\r\n        const action = Component.router.getActionForPathAndParams(path, params);\r\n        if (action) {\r\n          this.dispatch(action);\r\n        }\r\n      }\r\n    };\r\n\r\n    _onNavigationStateChange(prevNav, nav, action) {\r\n      if (\r\n        typeof this.props.onNavigationStateChange === 'undefined' &&\r\n        this._isStateful() &&\r\n        !!process.env.REACT_NAV_LOGGING\r\n      ) {\r\n        if (console.group) {\r\n          console.group('Navigation Dispatch: ');\r\n          console.log('Action: ', action);\r\n          console.log('New State: ', nav);\r\n          console.log('Last State: ', prevNav);\r\n          console.groupEnd();\r\n        } else {\r\n          console.log('Navigation Dispatch: ', {\r\n            action,\r\n            newState: nav,\r\n            lastState: prevNav,\r\n          });\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (typeof this.props.onNavigationStateChange === 'function') {\r\n        this.props.onNavigationStateChange(prevNav, nav, action);\r\n      }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n      // Clear cached _navState every tick\r\n      if (this._navState === this.state.nav) {\r\n        this._navState = null;\r\n      }\r\n    }\r\n\r\n    async componentDidMount() {\r\n      this._isMounted = true;\r\n      if (!this._isStateful()) {\r\n        return;\r\n      }\r\n\r\n      if (process.env.NODE_ENV !== 'production' && !this.props.detached) {\r\n        if (_statefulContainerCount > 0) {\r\n          // Temporarily only show this on iOS due to this issue:\r\n          // https://github.com/react-navigation/react-navigation/issues/4196#issuecomment-390827829\r\n          if (Platform.OS === 'ios') {\r\n            console.warn(\r\n              `You should only render one navigator explicitly in your app, and other navigators should be rendered by including them in that navigator. Full details at: ${docsUrl(\r\n                'common-mistakes.html#explicitly-rendering-more-than-one-navigator'\r\n              )}`\r\n            );\r\n          }\r\n        }\r\n      }\r\n      _statefulContainerCount++;\r\n      this._linkingSub = Linking.addEventListener('url', this._handleOpenURL);\r\n\r\n      // Pull out anything that can impact state\r\n      let parsedUrl = null;\r\n      let userProvidedStartupState = null;\r\n      if (this.props.enableURLHandling !== false) {\r\n        ({\r\n          parsedUrl,\r\n          userProvidedStartupState,\r\n        } = await this.getStartupParams());\r\n      }\r\n\r\n      // Initialize state. This must be done *after* any async code\r\n      // so we don't end up with a different value for this.state.nav\r\n      // due to changes while async function was resolving\r\n      let action = this._initialAction;\r\n      // eslint-disable-next-line react/no-access-state-in-setstate\r\n      let startupState = this.state.nav;\r\n      if (!startupState && !userProvidedStartupState) {\r\n        !!process.env.REACT_NAV_LOGGING &&\r\n          console.log('Init new Navigation State');\r\n        startupState = Component.router.getStateForAction(action);\r\n      }\r\n\r\n      // Pull user-provided persisted state\r\n      if (userProvidedStartupState) {\r\n        startupState = userProvidedStartupState;\r\n        _reactNavigationIsHydratingState = true;\r\n      }\r\n\r\n      // Pull state out of URL\r\n      if (parsedUrl) {\r\n        const { path, params } = parsedUrl;\r\n        const urlAction = Component.router.getActionForPathAndParams(\r\n          path,\r\n          params\r\n        );\r\n        if (urlAction) {\r\n          !!process.env.REACT_NAV_LOGGING &&\r\n            console.log(\r\n              'Applying Navigation Action for Initial URL:',\r\n              parsedUrl\r\n            );\r\n          action = urlAction;\r\n          startupState = Component.router.getStateForAction(\r\n            urlAction,\r\n            startupState\r\n          );\r\n        }\r\n      }\r\n\r\n      const dispatchActions = () =>\r\n        this._actionEventSubscribers.forEach((subscriber) =>\r\n          subscriber({\r\n            type: 'action',\r\n            action,\r\n            state: this.state.nav,\r\n            lastState: null,\r\n          })\r\n        );\r\n\r\n      if (startupState === this.state.nav) {\r\n        dispatchActions();\r\n        return;\r\n      }\r\n\r\n      // eslint-disable-next-line react/no-did-mount-set-state\r\n      this.setState({ nav: startupState }, () => {\r\n        _reactNavigationIsHydratingState = false;\r\n        dispatchActions();\r\n      });\r\n    }\r\n\r\n    async getStartupParams() {\r\n      const { uriPrefix, loadNavigationState } = this.props;\r\n      let url, loadedNavState;\r\n      try {\r\n        [url, loadedNavState] = await Promise.all([\r\n          Linking.getInitialURL(),\r\n          loadNavigationState && loadNavigationState(),\r\n        ]);\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n      return {\r\n        parsedUrl: url && urlToPathAndParams(url, uriPrefix),\r\n        userProvidedStartupState: loadedNavState,\r\n      };\r\n    }\r\n\r\n    componentDidCatch(e) {\r\n      if (_reactNavigationIsHydratingState) {\r\n        _reactNavigationIsHydratingState = false;\r\n        console.warn(\r\n          'Uncaught exception while starting app from persisted navigation state! Trying to render again with a fresh navigation state...'\r\n        );\r\n        this.dispatch(NavigationActions.init());\r\n      } else {\r\n        throw e;\r\n      }\r\n    }\r\n\r\n    _persistNavigationState = async (nav) => {\r\n      const { persistNavigationState } = this.props;\r\n      if (persistNavigationState) {\r\n        try {\r\n          await persistNavigationState(nav);\r\n        } catch (err) {\r\n          console.warn(\r\n            'Uncaught exception while calling persistNavigationState()! You should handle exceptions thrown from persistNavigationState(), ignoring them may result in undefined behavior.'\r\n          );\r\n        }\r\n      }\r\n    };\r\n\r\n    componentWillUnmount() {\r\n      this._isMounted = false;\r\n\r\n      // https://github.com/facebook/react-native/commit/6d1aca806cee86ad76de771ed3a1cc62982ebcd7\r\n      if (this._linkingSub?.remove) {\r\n        this._linkingSub?.remove();\r\n      } else {\r\n        Linking.removeEventListener('url', this._handleOpenURL);\r\n      }\r\n\r\n      this.subs && this.subs.remove();\r\n\r\n      if (this._isStateful()) {\r\n        _statefulContainerCount--;\r\n      }\r\n    }\r\n\r\n    // Per-tick temporary storage for state.nav\r\n\r\n    dispatch = (action) => {\r\n      if (this.props.navigation) {\r\n        return this.props.navigation.dispatch(action);\r\n      }\r\n\r\n      // navState will have the most up-to-date value, because setState sometimes behaves asyncronously\r\n      this._navState = this._navState || this.state.nav;\r\n      const lastNavState = this._navState;\r\n      invariant(lastNavState, 'should be set in constructor if stateful');\r\n      const reducedState = Component.router.getStateForAction(\r\n        action,\r\n        lastNavState\r\n      );\r\n      const navState = reducedState === null ? lastNavState : reducedState;\r\n\r\n      const dispatchActionEvents = () => {\r\n        this._actionEventSubscribers.forEach((subscriber) =>\r\n          subscriber({\r\n            type: 'action',\r\n            action,\r\n            state: navState,\r\n            lastState: lastNavState,\r\n          })\r\n        );\r\n      };\r\n\r\n      if (reducedState === null) {\r\n        // The router will return null when action has been handled and the state hasn't changed.\r\n        // dispatch returns true when something has been handled.\r\n        dispatchActionEvents();\r\n        return true;\r\n      }\r\n\r\n      if (navState !== lastNavState) {\r\n        // Cache updates to state.nav during the tick to ensure that subsequent calls will not discard this change\r\n        this._navState = navState;\r\n        this.setState({ nav: navState }, () => {\r\n          this._onNavigationStateChange(lastNavState, navState, action);\r\n          dispatchActionEvents();\r\n          this._persistNavigationState(navState);\r\n        });\r\n        return true;\r\n      }\r\n\r\n      dispatchActionEvents();\r\n      return false;\r\n    };\r\n\r\n    _getScreenProps = () => this.props.screenProps;\r\n\r\n    _getTheme = () => {\r\n      if (this.props.theme === 'light' || this.props.theme === 'dark') {\r\n        return this.props.theme;\r\n      } else if (this.props.theme === 'no-preference') {\r\n        return 'light';\r\n      } else {\r\n        console.warn(\r\n          `Invalid theme provided: ${this.props.theme}. Only 'light' and 'dark' are supported. Falling back to 'light'`\r\n        );\r\n        return 'light';\r\n      }\r\n    };\r\n\r\n    render() {\r\n      let navigation = this.props.navigation;\r\n      if (this._isStateful()) {\r\n        const navState = this.state.nav;\r\n        if (!navState) {\r\n          return this._renderLoading();\r\n        }\r\n        if (!this._navigation || this._navigation.state !== navState) {\r\n          this._navigation = getNavigation(\r\n            Component.router,\r\n            navState,\r\n            this.dispatch,\r\n            this._actionEventSubscribers,\r\n            this._getScreenProps,\r\n            () => this._navigation\r\n          );\r\n        }\r\n        navigation = this._navigation;\r\n      }\r\n      invariant(navigation, 'failed to get navigation');\r\n\r\n      return (\r\n        <ThemeProvider value={this._getTheme()}>\r\n          <NavigationProvider value={navigation}>\r\n            <Component {...this.props} navigation={navigation} />\r\n          </NavigationProvider>\r\n        </ThemeProvider>\r\n      );\r\n    }\r\n  }\r\n\r\n  return NavigationContainer;\r\n}\r\n"]}